<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        [v-cloak] { display: none; }
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #e9e5f3; 
            background-image: url("https://www.transparenttextures.com/patterns/food.png"); 
            color: #334155; 
        }
        .app-section { background-color: #fcfaf2; border-radius: 20px; padding: 24px; border: 1px solid #f0ede4; }
        
        .photo-card {
            aspect-ratio: 1/1; background: white; padding: 10px 10px 30px 10px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); transform: rotate(-1.5deg);
        }

        @media print {
            .no-print { display: none !important; }
            .card { box-shadow: none !important; border: none !important; background: white !important; }
            body { background: white !important; }
        }
    </style>
</head>
<body>

<div id="app" v-cloak class="max-w-[1400px] mx-auto p-6 md:p-10">
    <div class="flex justify-between items-center mb-8 no-print bg-white/80 backdrop-blur-md p-4 rounded-2xl shadow-lg border border-white">
        <div class="flex items-center gap-4">
            <button @click="saveRecipe" class="flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg font-bold hover:bg-purple-700 transition-all">
                <i class="ph ph-floppy-disk"></i> Save JSON
            </button>
            <button @click="$refs.fileInput.click()" class="flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-700 rounded-lg font-bold hover:bg-slate-200 transition-all">
                <i class="ph ph-folder-open"></i> Load JSON
            </button>
            <input type="file" ref="fileInput" @change="loadRecipe" accept=".json" class="hidden">
        </div>
        
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
                <span class="text-[10px] font-black uppercase text-slate-400">Scale</span>
                <select v-model="scale" class="bg-white border rounded-md py-1 px-2 text-sm font-bold text-purple-700">
                    <option :value="0.5">0.5x</option>
                    <option :value="1">1x</option>
                    <option :value="2">2x</option>
                </select>
            </div>
            <button onclick="window.print()" class="p-2 hover:bg-slate-100 rounded-full"><i class="ph ph-printer text-2xl"></i></button>
        </div>
    </div>

    <div class="card bg-white shadow-2xl rounded-[40px] p-10 md:p-16 border border-white/50 relative">
        <div class="flex flex-col md:flex-row items-start md:items-center gap-8 mb-12">
            <div class="relative group no-print">
                <div class="w-24 h-24 bg-purple-100 rounded-3xl flex items-center justify-center text-purple-500 text-5xl shadow-inner">
                    <i :class="categories.find(c => c.name === selectedCategory)?.icon || 'ph ph-cooking-pot'"></i>
                </div>
                <select v-model="selectedCategory" class="absolute inset-0 opacity-0 cursor-pointer">
                    <option v-for="cat in categories" :key="cat.name" :value="cat.name">{{ cat.name }}</option>
                </select>
            </div>
            <div class="flex-grow">
                <span class="text-purple-400 font-bold uppercase tracking-[0.2em] text-xs">Recipe Name</span>
                <input v-model="recipeTitle" placeholder="Untitled Recipe" class="text-5xl font-black w-full focus:outline-none bg-transparent block">
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
            <div class="space-y-10">
                <section class="app-section">
                    <h2 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-6 border-b pb-3">Mise en Place</h2>
                    <div v-for="(item, index) in miseEnPlace" :key="index" class="flex gap-3 mb-2">
                        <input v-model="item.text" placeholder="Prep task..." class="flex-grow bg-transparent border-none focus:ring-0">
                        <button @click="miseEnPlace.splice(index, 1)" class="no-print text-slate-300 hover:text-red-400"><i class="ph ph-x"></i></button>
                    </div>
                    <button @click="miseEnPlace.push({text: ''})" class="mt-4 text-purple-600 text-xs font-black no-print">+ ADD TASK</button>
                </section>

                <section class="app-section">
                    <h2 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-6 border-b pb-3">Ingredients</h2>
                    <div v-for="(ing, index) in ingredients" :key="index" class="flex items-center gap-3 mb-3">
                        <input v-model.number="ing.amount" type="number" step="any" class="w-16 text-right font-mono font-bold text-purple-600 bg-white p-1 rounded">
                        <input v-model="ing.unit" placeholder="Unit" class="w-12 text-xs font-black uppercase text-slate-500 bg-transparent">
                        <input v-model="ing.name" placeholder="Ingredient..." class="flex-grow bg-transparent">
                        <button @click="ingredients.splice(index, 1)" class="no-print text-slate-300 hover:text-red-400"><i class="ph ph-trash"></i></button>
                    </div>
                    <button @click="addIngredient" class="mt-4 text-purple-600 text-xs font-black no-print">+ ADD INGREDIENT</button>
                </section>

                <section class="app-section">
                    <h2 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-6 border-b pb-3">Photos</h2>
                    <div class="grid grid-cols-2 gap-6">
                        <div v-for="(img, idx) in images" :key="idx" class="relative group">
                            <div class="photo-card"><img :src="img" class="w-full h-full object-cover"></div>
                            <button @click="images.splice(idx, 1)" class="absolute top-0 right-0 bg-red-500 text-white rounded-full w-6 h-6 no-print opacity-0 group-hover:opacity-100">Ã—</button>
                        </div>
                        <button @click="$refs.imgUp.click()" class="border-2 border-dashed border-slate-200 rounded-2xl flex flex-col items-center justify-center p-8 text-slate-400 hover:text-purple-400 no-print">
                            <i class="ph ph-camera text-3xl mb-2"></i>
                            <span class="text-[10px] font-bold">ADD PHOTO</span>
                        </button>
                        <input type="file" ref="imgUp" multiple accept="image/*" class="hidden" @change="handleImage">
                    </div>
                </section>
            </div>

            <div class="space-y-10">
                <section class="app-section">
                    <h2 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-6 border-b pb-3">Method</h2>
                    <div v-for="(step, index) in method" :key="index" class="flex gap-4 mb-6 items-start">
                        <span class="text-3xl font-black text-slate-200 mt-1 w-8">{{ index + 1 }}</span>
                        <textarea v-model="step.text" rows="3" class="flex-grow p-4 bg-white rounded-xl outline-none resize-none border border-slate-50" placeholder="Step instructions..."></textarea>
                        <button @click="method.splice(index, 1)" class="no-print text-slate-300 hover:text-red-400 mt-4"><i class="ph ph-trash"></i></button>
                    </div>
                    <button @click="addMethod" class="text-purple-600 text-xs font-black no-print">+ ADD STEP</button>
                </section>

                <section class="app-section bg-amber-50/50 border-amber-100">
                    <h2 class="text-xs font-black uppercase tracking-widest text-amber-600/40 mb-4">Chef's Notes</h2>
                    <textarea v-model="notes" rows="4" class="w-full bg-transparent border-none focus:ring-0" placeholder="Tips, substitutions, or variations..."></textarea>
                </section>
            </div>
        </div>
    </div>
</div>

<script>
const { createApp } = Vue;

createApp({
    data() {
        return {
            recipeTitle: '',
            scale: 1,
            selectedCategory: 'Mains',
            categories: [
                { name: 'Mains', icon: 'ph ph-cooking-pot' },
                { name: 'Baking', icon: 'ph ph-bread' },
                { name: 'Dessert', icon: 'ph ph-cookie' },
                { name: 'Breakfast', icon: 'ph ph-egg' }
            ],
            miseEnPlace: [{ text: '' }],
            ingredients: [{ amount: null, unit: 'g', name: '' }],
            method: [{ text: '' }],
            images: [],
            notes: ''
        }
    },
    methods: {
        saveRecipe() {
            const data = JSON.stringify(this.$data);
            const blob = new Blob([data], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `${this.recipeTitle.replace(/\s+/g, '_') || 'recipe'}.json`;
            a.click();
        },
        loadRecipe(e) {
            const reader = new FileReader();
            reader.onload = (event) => Object.assign(this, JSON.parse(event.target.result));
            reader.readAsText(e.target.files[0]);
        },
        handleImage(e) {
            Array.from(e.target.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = (ev) => this.images.push(ev.target.result);
                reader.readAsDataURL(file);
            });
        },
        addIngredient() { this.ingredients.push({ amount: null, unit: 'g', name: '' }); },
        addMethod() { this.method.push({ text: '' }); }
    }
}).mount('#app');
</script>
</body>
</html>
